===============================================================================

　マウス・キーボード操作の記録と再生

===============================================================================


■ソフトの概要

　ポインタ移動・クリック・ドラッグといったマウス操作とキーボード操作を記録・保存して、
　何度でも好きな時に同じ操作を行えるようにするプログラムです。
　ホイールの操作は未対応です。

　マウス・キーボード操作は外部コマンドの羅列としてバッチファイルに書き出し、
　バッチファイルの実行によりマウス・キーボード操作を再現します。

　ただのバッチファイルなので加工も自由です。


■動作環境

　Windows 10
　確認していませんが Windows 7/8/8.1 でも動くかもしれません。

　.NET Framework 4 を使用します。(GUIのみ)


■インストール方法

　アーカイブの中身をローカルディスク上の任意の場所にコピーして下さい。


■アンインストール方法

　レジストリなどは一切使っていません。
　ファイルを削除するだけでアンインストールできます。


■起動方法

　WRec.exe を実行して下さい。


■チュートリアル

　1. [開始] ボタンを押して下さい。

　2. 何か適当なマウス・キーボード操作を行って下さい。
　　(後で再現されるので、無難な操作を行って下さい)

　3. [停止] ボタンを押して下さい。

　4. バッチファイルの保存ダイアログが表示されるので、どこか適当な場所を指定して保存して下さい。

　5. [再生] ボタンを押して下さい。

　6. バッチファイルを開くダイアログが表示されるので、先ほど保存したバッチファイルを選択して下さい。

　7. (2.) で行ったマウス・キーボード操作が再現されたら成功です。


■注意

　再生する (バッチファイルを実行する) とマウス・キーボードの操作が困難になり、
　バッチファイルを中断したくても中断できない状況に陥るかもしれません。
　設定 / 再生 / 右コントロール押下でも中断する にチェックを入れることをお勧めします。
　WRec.exe の再生ボタンから実行している限り、右コントロール押下でバッチファイルを強制終了できるようになります。

　※バッチファイルの強制終了は非常手段としてご利用下さい。


■設定

　●常に手前に表示する

　　WRec.exe のウィンドウを常に手前に表示するようにします。


　●繰り返し再生する

　　再生終了後、同じバッチファイルを繰り返し実行します。
　　実行前に確認ダイアログが表示されるので、中止するには５秒以内にキャンセルボタンを押して下さい。


　●SndInput.exe をローカル名で呼び出す

　　バッチファイル内の SndInput.exe を呼び出すコマンドパスをローカル名で書き出します。
　　チェックを外すと、フルパスで書き出します。


　●キーストロークと見なすキーの押下時間

　　記録時、キーを押してから放すまでの時間が指定時間以内の場合、キーストローク (１文字入力) と見なします。
　　単位はミリ秒です。
　　サンプリング間隔が10ミリ秒であるため、10より小さい端数は無視されます。
　　0 を指定すると、どのようなキー操作もキーストロークと見なしません。


　●クリックと見なすボタンの押下時間

　　記録時、マウスボタンを押してから放すまでの時間が指定時間以内の場合、クリックと見なします。
　　単位はミリ秒です。
　　サンプリング間隔が10ミリ秒であるため、10より小さい端数は無視されます。
　　0 を指定すると、どのようなボタン操作もクリックと見なしません。


　●ダブルクリックと見なすクリックの間隔

　　記録時、クリックの間隔 (ボタンを放してから押すまでの時間) が指定時間以内の場合、ダブルクリックと見なします。
　　単位はミリ秒です。
　　サンプリング間隔が10ミリ秒であるため、10より小さい端数は無視されます。
　　0 を指定すると、どのようなボタン操作もダブルクリックと見なしません。


　●複数の操作をなるたけ１つのコマンドにまとめる

　　短い時間にマウス・キーボード操作が集中した場合、成る丈１つのコマンドにまとめるようにします。
　　チェックを外すと、サンプリング単位でコマンド行が生成されます。
　　(クリック・ダブルクリック・キーストロークは常に１つのコマンドにまとめます)


　●再生時のキーストロークのキー押下時間

　　再生時、キーストロークのキーを押してから放すまでの時間を指定します。
　　キーストロークが速すぎて認識されない場合、値を大きくしてみて下さい。
　　キーストロークが遅すぎて文字が連続入力になってしまう場合、値を小さくしてみて下さい。
　　単位はミリ秒です。


　●再生時のクリックのボタン押下時間

　　再生時、クリックのマウスボタンを押してから放すまでの時間を指定します。
　　クリックが速すぎて認識されない場合、値を大きくしてみて下さい。
　　クリックが遅すぎてドラッグになってしまう場合、値を小さくしてみて下さい。
　　単位はミリ秒です。


　●再生時のダブルクリックのクリック間隔

　　再生時、ダブルクリックのクリック間隔を指定します。
　　クリック間隔が短すぎて認識されない場合、値を大きくしてみて下さい。
　　クリック間隔が長すぎて２回クリックになってしまう場合、値を小さくしてみて下さい。
　　単位はミリ秒です。


　●記録時のサンプリング間隔(ミリ秒)

　　10ミリ秒固定です。


　●再生時のサンプリング間隔(ミリ秒)

　　再生は単にバッチファイルを実行するだけなので遅くなります。
　　ゆっくり過ぎる場合、値を小さくしてみて下さい。
　　逆にもっとゆっくり再生したい場合、値を大きくしてみて下さい。


　●開始時に最小化する [記録]

　　記録開始時にウィンドウを最小化します。


　●終了時に元のサイズに戻す [記録]

　　記録終了時にウィンドウを元のサイズに戻します。


　●右コントロール押下でも停止する

　　記録中、右コントロールを押下すると記録終了できるようにします。


　●開始時に最小化する [再生]

　　再生開始時にウィンドウを最小化します。


　●終了時に元のサイズに戻す [再生]

　　再生終了時にウィンドウを元のサイズに戻します。


　●右コントロール押下でも中断する

　　再生中、右コントロールを押下すると再生終了 (強制終了) できるようにします。


　●リセット

　　設定ダイアログを開いたときの状態に戻します。


■CUIのコマンド引数

　SndInput.exe MC X-Pos Y-Pos

　　マウスカーソルを移動します。

　　　X-Pos ... X-座標
　　　Y-Pos ... Y-座標

　　例) SndInput MC 123 456   ... マウスカーソルを (123,456) に移動する。


　SndInput.exe MB Btn Dwn

　　マウスボタンを操作します。

　　　Btn ... 1 = 左ボタン, 2 = 中央ボタン, 3 = 右ボタン
　　　Dwn ... 1 = 押す, 0 = 放す

　　例) SndInput MB 1 1   ... 左ボタンを押す。


　SndInput.exe MW Lvl

　　マウスホイールを操作します。

　　　Lvl ... 回転量を整数で指定します。
　　　　　　　マイナスは手前に、プラスは奥の方に転がします。

　　例) SndInput MW -3   ... マウスホイールを手前に 3 コロする。
　　例) SndInput MW 5    ... マウスホイールを奥の方に 5 コロする。


　SndInput.exe KB Vk Dwn

　　キーボードを操作します。

　　　Vk  ... 仮想キーコード
　　　Dwn ... 1 = 押す, 0 = 放す

　　例) SndInput KB 32 1   ... スペースキーを押す。


　SndInput.exe T Millis

　　指定時間ウェイトします。

　　　Millis ... ミリ秒

　　例) SndInput T 100   ... 100ミリ秒ウェイトする。


　★コマンド引数は複数指定できます。

　　例)

　　　SndInput KB 32 1
　　　SndInput T 30
　　　SndInput KB 32 0

　　　は、以下のように１つのコマンドにまとめられます。

　　　SndInput KB 32 1 T 30 KB 32 0


■制限

　１回の記録時間の上限はおよそ１時間です。
　記録時間の上限に達するとエラーになり記録開始からの操作データは失われます。
　ていうか、あんまり長い時間 (10分とか、20分とか) やるとメモリ足んなくなって落ちるかも。

　停止ボタンのクリックを記録してしまわないよう、
　停止前 300 ミリ秒くらいは左ボタン操作が記録されないかもしれません。

　再生、もう一度再生する の作業ディレクトリは、常に WRec.exe と同じ場所です。


■取り扱い種別

　フリーソフト


■作者への連絡先

　stackprobes@gmail.com

　バグや要望などご連絡ください。

